{
    "check_type": "terraform",
    "results": {
        "passed_checks": [
            {
                "check_id": "CUSTOM_LAMBDA_MEMORY_LIMIT",
                "bc_check_id": null,
                "check_name": "Ensure Lambda function memory size does not exceed 5 GB",
                "check_result": {
                    "result": "PASSED",
                    "entity": {
                        "aws_lambda_function": {
                            "this": {
                                "__end_line__": 62,
                                "__start_line__": 27,
                                "dynamic": [
                                    {
                                        "vpc_config": [
                                            {
                                                "security_group_ids": [
                                                    "var.security_group_ids"
                                                ],
                                                "subnet_ids": [
                                                    "var.subnet_ids"
                                                ]
                                            }
                                        ]
                                    }
                                ],
                                "environment": [
                                    {
                                        "variables": [
                                            {
                                                "ENV": "dev"
                                            }
                                        ]
                                    }
                                ],
                                "filename": [
                                    "lambda.zip"
                                ],
                                "function_name": [
                                    "my-lambda-function"
                                ],
                                "handler": [
                                    "main.handler"
                                ],
                                "image_uri": [
                                    "None"
                                ],
                                "layers": [
                                    []
                                ],
                                "memory_size": [
                                    128
                                ],
                                "package_type": [
                                    "Zip"
                                ],
                                "role": [
                                    "aws_iam_role.lambda_exec[0].arn"
                                ],
                                "runtime": [
                                    "python3.10"
                                ],
                                "s3_bucket": [
                                    "my-lambda-artifacts"
                                ],
                                "s3_key": [
                                    "lambda.zip"
                                ],
                                "source_code_hash": [
                                    ""
                                ],
                                "tags": [
                                    {
                                        "Environment": "dev",
                                        "Project": "lambda-demo"
                                    }
                                ],
                                "timeout": [
                                    10
                                ],
                                "__address__": "aws_lambda_function.this"
                            }
                        }
                    },
                    "evaluated_keys": [
                        "memory_size"
                    ]
                },
                "code_block": [
                    [
                        27,
                        "resource \"aws_lambda_function\" \"this\" {\n"
                    ],
                    [
                        28,
                        "  function_name = var.name\n"
                    ],
                    [
                        29,
                        "\n"
                    ],
                    [
                        30,
                        "  role = var.create_role ? aws_iam_role.lambda_exec[0].arn : var.role_arn\n"
                    ],
                    [
                        31,
                        "\n"
                    ],
                    [
                        32,
                        "  package_type = var.use_image ? \"Image\" : \"Zip\"\n"
                    ],
                    [
                        33,
                        "\n"
                    ],
                    [
                        34,
                        "  # ZIP-based\n"
                    ],
                    [
                        35,
                        "  filename         = var.use_image == false ? var.filename : null\n"
                    ],
                    [
                        36,
                        "  s3_bucket        = var.use_image == false ? var.s3_bucket : null\n"
                    ],
                    [
                        37,
                        "  s3_key           = var.use_image == false ? var.s3_key : null\n"
                    ],
                    [
                        38,
                        "  source_code_hash = var.use_image == false ? var.source_code_hash : null\n"
                    ],
                    [
                        39,
                        "  runtime          = var.use_image == false ? var.runtime : null\n"
                    ],
                    [
                        40,
                        "  handler          = var.use_image == false ? var.handler : null\n"
                    ],
                    [
                        41,
                        "  layers           = var.use_image == false ? var.layers : null\n"
                    ],
                    [
                        42,
                        "\n"
                    ],
                    [
                        43,
                        "  # Image-based\n"
                    ],
                    [
                        44,
                        "  image_uri = var.use_image == true ? var.image_uri : null\n"
                    ],
                    [
                        45,
                        "\n"
                    ],
                    [
                        46,
                        "  timeout     = var.timeout\n"
                    ],
                    [
                        47,
                        "  memory_size = var.memory_size\n"
                    ],
                    [
                        48,
                        "\n"
                    ],
                    [
                        49,
                        "  environment {\n"
                    ],
                    [
                        50,
                        "    variables = var.environment_variables\n"
                    ],
                    [
                        51,
                        "  }\n"
                    ],
                    [
                        52,
                        "\n"
                    ],
                    [
                        53,
                        "  dynamic \"vpc_config\" {\n"
                    ],
                    [
                        54,
                        "    for_each = var.custom_vpc_enabled ? [1] : []\n"
                    ],
                    [
                        55,
                        "    content {\n"
                    ],
                    [
                        56,
                        "      subnet_ids         = var.subnet_ids\n"
                    ],
                    [
                        57,
                        "      security_group_ids = var.security_group_ids\n"
                    ],
                    [
                        58,
                        "    }\n"
                    ],
                    [
                        59,
                        "  }\n"
                    ],
                    [
                        60,
                        "\n"
                    ],
                    [
                        61,
                        "  tags = var.tags\n"
                    ],
                    [
                        62,
                        "}\n"
                    ]
                ],
                "file_path": "/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_abs_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "repo_file_path": "/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_line_range": [
                    27,
                    62
                ],
                "resource": "aws_lambda_function.this",
                "evaluations": null,
                "check_class": "checkov.common.graph.checks_infra.base_check",
                "fixed_definition": null,
                "entity_tags": {
                    "Environment": "dev",
                    "Project": "lambda-demo"
                },
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": "HIGH",
                "bc_category": null,
                "benchmarks": {},
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": null,
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "breadcrumbs": {
                    "function_name": [
                        {
                            "type": "variable",
                            "name": "name",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        },
                        {
                            "type": "resource",
                            "name": "aws_lambda_function.this",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                            "module_connection": false
                        }
                    ],
                    "filename": [
                        {
                            "type": "variable",
                            "name": "filename",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "handler": [
                        {
                            "type": "variable",
                            "name": "handler",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "image_uri": [
                        {
                            "type": "variable",
                            "name": "image_uri",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "layers": [
                        {
                            "type": "variable",
                            "name": "layers",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "package_type": [
                        {
                            "type": "variable",
                            "name": "use_image",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "runtime": [
                        {
                            "type": "variable",
                            "name": "runtime",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "s3_bucket": [
                        {
                            "type": "variable",
                            "name": "s3_bucket",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "s3_key": [
                        {
                            "type": "variable",
                            "name": "s3_key",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "source_code_hash": [
                        {
                            "type": "variable",
                            "name": "source_code_hash",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "timeout": [
                        {
                            "type": "variable",
                            "name": "timeout",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "memory_size": [
                        {
                            "type": "variable",
                            "name": "memory_size",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "environment.variables": [
                        {
                            "type": "variable",
                            "name": "environment_variables",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "tags": [
                        {
                            "type": "variable",
                            "name": "tags",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.content.subnet_ids": [
                        {
                            "type": "variable",
                            "name": "subnet_ids",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.content": [
                        {
                            "type": "variable",
                            "name": "security_group_ids",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config": [
                        {
                            "type": "variable",
                            "name": "custom_vpc_enabled",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.content.security_group_ids": [
                        {
                            "type": "variable",
                            "name": "security_group_ids",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.for_each": [
                        {
                            "type": "variable",
                            "name": "custom_vpc_enabled",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "role": [
                        {
                            "type": "variable",
                            "name": "role_arn",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CUSTOM_IAM_ASSUME_ROLE_NO_WILDCARD",
                "bc_check_id": null,
                "check_name": "Ensure IAM assume role trust policy does not allow all principals",
                "check_result": {
                    "result": "PASSED",
                    "entity": {
                        "aws_iam_role": {
                            "lambda_exec[0]": {
                                "__end_line__": 18,
                                "__start_line__": 1,
                                "assume_role_policy": [
                                    {
                                        "Version": "2012-10-17",
                                        "Statement": [
                                            {
                                                "Effect": "Allow",
                                                "Action": "sts:AssumeRole",
                                                "Principal": {
                                                    "Service": "lambda.amazonaws.com"
                                                }
                                            }
                                        ]
                                    }
                                ],
                                "name": [
                                    "my-lambda-function-exec-role"
                                ],
                                "tags": [
                                    {
                                        "Environment": "dev",
                                        "Project": "lambda-demo"
                                    }
                                ],
                                "__address__": "aws_iam_role.lambda_exec[0]"
                            }
                        }
                    },
                    "evaluated_keys": [
                        "assume_role_policy"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"aws_iam_role\" \"lambda_exec\" {\n"
                    ],
                    [
                        2,
                        "  count = var.create_role ? 1 : 0\n"
                    ],
                    [
                        3,
                        "\n"
                    ],
                    [
                        4,
                        "  name = \"${var.name}-exec-role\"\n"
                    ],
                    [
                        5,
                        "\n"
                    ],
                    [
                        6,
                        "  assume_role_policy = jsonencode({\n"
                    ],
                    [
                        7,
                        "    Version = \"2012-10-17\"\n"
                    ],
                    [
                        8,
                        "    Statement = [{\n"
                    ],
                    [
                        9,
                        "      Effect = \"Allow\"\n"
                    ],
                    [
                        10,
                        "      Action = \"sts:AssumeRole\"\n"
                    ],
                    [
                        11,
                        "      Principal = {\n"
                    ],
                    [
                        12,
                        "        Service = \"lambda.amazonaws.com\"\n"
                    ],
                    [
                        13,
                        "      }\n"
                    ],
                    [
                        14,
                        "    }]\n"
                    ],
                    [
                        15,
                        "  })\n"
                    ],
                    [
                        16,
                        "\n"
                    ],
                    [
                        17,
                        "  tags = var.tags\n"
                    ],
                    [
                        18,
                        "}\n"
                    ]
                ],
                "file_path": "/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_abs_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "repo_file_path": "/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_line_range": [
                    1,
                    18
                ],
                "resource": "aws_iam_role.lambda_exec[0]",
                "evaluations": null,
                "check_class": "checkov.common.graph.checks_infra.base_check",
                "fixed_definition": null,
                "entity_tags": {
                    "Environment": "dev",
                    "Project": "lambda-demo"
                },
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": "CRITICAL",
                "bc_category": null,
                "benchmarks": {},
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": null,
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "variable",
                            "name": "name",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "tags": [
                        {
                            "type": "variable",
                            "name": "tags",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ]
                }
            }
        ],
        "failed_checks": [
            {
                "check_id": "CUSTOM_IAM_ROLE_TAGS",
                "bc_check_id": null,
                "check_name": "Ensure IAM role has required tags",
                "check_result": {
                    "result": "FAILED",
                    "entity": {
                        "aws_iam_role": {
                            "lambda_exec[0]": {
                                "__end_line__": 18,
                                "__start_line__": 1,
                                "assume_role_policy": [
                                    {
                                        "Version": "2012-10-17",
                                        "Statement": [
                                            {
                                                "Effect": "Allow",
                                                "Action": "sts:AssumeRole",
                                                "Principal": {
                                                    "Service": "lambda.amazonaws.com"
                                                }
                                            }
                                        ]
                                    }
                                ],
                                "name": [
                                    "my-lambda-function-exec-role"
                                ],
                                "tags": [
                                    {
                                        "Environment": "dev",
                                        "Project": "lambda-demo"
                                    }
                                ],
                                "__address__": "aws_iam_role.lambda_exec[0]"
                            }
                        }
                    },
                    "evaluated_keys": [
                        "tags/Environment",
                        "tags/Owner"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"aws_iam_role\" \"lambda_exec\" {\n"
                    ],
                    [
                        2,
                        "  count = var.create_role ? 1 : 0\n"
                    ],
                    [
                        3,
                        "\n"
                    ],
                    [
                        4,
                        "  name = \"${var.name}-exec-role\"\n"
                    ],
                    [
                        5,
                        "\n"
                    ],
                    [
                        6,
                        "  assume_role_policy = jsonencode({\n"
                    ],
                    [
                        7,
                        "    Version = \"2012-10-17\"\n"
                    ],
                    [
                        8,
                        "    Statement = [{\n"
                    ],
                    [
                        9,
                        "      Effect = \"Allow\"\n"
                    ],
                    [
                        10,
                        "      Action = \"sts:AssumeRole\"\n"
                    ],
                    [
                        11,
                        "      Principal = {\n"
                    ],
                    [
                        12,
                        "        Service = \"lambda.amazonaws.com\"\n"
                    ],
                    [
                        13,
                        "      }\n"
                    ],
                    [
                        14,
                        "    }]\n"
                    ],
                    [
                        15,
                        "  })\n"
                    ],
                    [
                        16,
                        "\n"
                    ],
                    [
                        17,
                        "  tags = var.tags\n"
                    ],
                    [
                        18,
                        "}\n"
                    ]
                ],
                "file_path": "/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_abs_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "repo_file_path": "/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_line_range": [
                    1,
                    18
                ],
                "resource": "aws_iam_role.lambda_exec[0]",
                "evaluations": null,
                "check_class": "checkov.common.graph.checks_infra.base_check",
                "fixed_definition": null,
                "entity_tags": {
                    "Environment": "dev",
                    "Project": "lambda-demo"
                },
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": "MEDIUM",
                "bc_category": null,
                "benchmarks": {},
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": null,
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "variable",
                            "name": "name",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "tags": [
                        {
                            "type": "variable",
                            "name": "tags",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CUSTOM_PUBLIC_LAMBDA_TAG_ENFORCEMENT",
                "bc_check_id": null,
                "check_name": "Public Lambda URL must be explicitly tagged",
                "check_result": {
                    "result": "FAILED",
                    "entity": {
                        "aws_lambda_function_url": {
                            "this[0]": {
                                "__end_line__": 74,
                                "__start_line__": 64,
                                "authorization_type": [
                                    "NONE"
                                ],
                                "cors": [
                                    {
                                        "allow_headers": [
                                            [
                                                "*"
                                            ]
                                        ],
                                        "allow_methods": [
                                            [
                                                "*"
                                            ]
                                        ],
                                        "allow_origins": [
                                            [
                                                "*"
                                            ]
                                        ]
                                    }
                                ],
                                "function_name": [
                                    "my-lambda-function"
                                ],
                                "__address__": "aws_lambda_function_url.this[0]"
                            }
                        }
                    },
                    "evaluated_keys": [
                        "function_url/auth_type",
                        "tags/purpose"
                    ]
                },
                "code_block": [
                    [
                        64,
                        "resource \"aws_lambda_function_url\" \"this\" {\n"
                    ],
                    [
                        65,
                        "  count              = var.enable_function_url ? 1 : 0\n"
                    ],
                    [
                        66,
                        "  function_name      = aws_lambda_function.this.function_name\n"
                    ],
                    [
                        67,
                        "  authorization_type = var.function_url_auth_type\n"
                    ],
                    [
                        68,
                        "\n"
                    ],
                    [
                        69,
                        "  cors {\n"
                    ],
                    [
                        70,
                        "    allow_origins = [\"*\"]\n"
                    ],
                    [
                        71,
                        "    allow_methods = [\"*\"]\n"
                    ],
                    [
                        72,
                        "    allow_headers = [\"*\"]\n"
                    ],
                    [
                        73,
                        "  }\n"
                    ],
                    [
                        74,
                        "}\n"
                    ]
                ],
                "file_path": "/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_abs_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "repo_file_path": "/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_line_range": [
                    64,
                    74
                ],
                "resource": "aws_lambda_function_url.this[0]",
                "evaluations": null,
                "check_class": "checkov.common.graph.checks_infra.base_check",
                "fixed_definition": null,
                "entity_tags": {},
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": "HIGH",
                "bc_category": null,
                "benchmarks": {},
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": null,
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "breadcrumbs": {
                    "authorization_type": [
                        {
                            "type": "variable",
                            "name": "function_url_auth_type",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "function_name": [
                        {
                            "type": "variable",
                            "name": "name",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        },
                        {
                            "type": "resource",
                            "name": "aws_lambda_function.this",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CUSTOM_LAMBDA_IMAGE_ONLY",
                "bc_check_id": null,
                "check_name": "Ensure Lambda function uses only container image packaging",
                "check_result": {
                    "result": "FAILED",
                    "entity": {
                        "aws_lambda_function": {
                            "this": {
                                "__end_line__": 62,
                                "__start_line__": 27,
                                "dynamic": [
                                    {
                                        "vpc_config": [
                                            {
                                                "security_group_ids": [
                                                    "var.security_group_ids"
                                                ],
                                                "subnet_ids": [
                                                    "var.subnet_ids"
                                                ]
                                            }
                                        ]
                                    }
                                ],
                                "environment": [
                                    {
                                        "variables": [
                                            {
                                                "ENV": "dev"
                                            }
                                        ]
                                    }
                                ],
                                "filename": [
                                    "lambda.zip"
                                ],
                                "function_name": [
                                    "my-lambda-function"
                                ],
                                "handler": [
                                    "main.handler"
                                ],
                                "image_uri": [
                                    "None"
                                ],
                                "layers": [
                                    []
                                ],
                                "memory_size": [
                                    128
                                ],
                                "package_type": [
                                    "Zip"
                                ],
                                "role": [
                                    "aws_iam_role.lambda_exec[0].arn"
                                ],
                                "runtime": [
                                    "python3.10"
                                ],
                                "s3_bucket": [
                                    "my-lambda-artifacts"
                                ],
                                "s3_key": [
                                    "lambda.zip"
                                ],
                                "source_code_hash": [
                                    ""
                                ],
                                "tags": [
                                    {
                                        "Environment": "dev",
                                        "Project": "lambda-demo"
                                    }
                                ],
                                "timeout": [
                                    10
                                ],
                                "__address__": "aws_lambda_function.this"
                            }
                        }
                    },
                    "evaluated_keys": [
                        "package_type"
                    ]
                },
                "code_block": [
                    [
                        27,
                        "resource \"aws_lambda_function\" \"this\" {\n"
                    ],
                    [
                        28,
                        "  function_name = var.name\n"
                    ],
                    [
                        29,
                        "\n"
                    ],
                    [
                        30,
                        "  role = var.create_role ? aws_iam_role.lambda_exec[0].arn : var.role_arn\n"
                    ],
                    [
                        31,
                        "\n"
                    ],
                    [
                        32,
                        "  package_type = var.use_image ? \"Image\" : \"Zip\"\n"
                    ],
                    [
                        33,
                        "\n"
                    ],
                    [
                        34,
                        "  # ZIP-based\n"
                    ],
                    [
                        35,
                        "  filename         = var.use_image == false ? var.filename : null\n"
                    ],
                    [
                        36,
                        "  s3_bucket        = var.use_image == false ? var.s3_bucket : null\n"
                    ],
                    [
                        37,
                        "  s3_key           = var.use_image == false ? var.s3_key : null\n"
                    ],
                    [
                        38,
                        "  source_code_hash = var.use_image == false ? var.source_code_hash : null\n"
                    ],
                    [
                        39,
                        "  runtime          = var.use_image == false ? var.runtime : null\n"
                    ],
                    [
                        40,
                        "  handler          = var.use_image == false ? var.handler : null\n"
                    ],
                    [
                        41,
                        "  layers           = var.use_image == false ? var.layers : null\n"
                    ],
                    [
                        42,
                        "\n"
                    ],
                    [
                        43,
                        "  # Image-based\n"
                    ],
                    [
                        44,
                        "  image_uri = var.use_image == true ? var.image_uri : null\n"
                    ],
                    [
                        45,
                        "\n"
                    ],
                    [
                        46,
                        "  timeout     = var.timeout\n"
                    ],
                    [
                        47,
                        "  memory_size = var.memory_size\n"
                    ],
                    [
                        48,
                        "\n"
                    ],
                    [
                        49,
                        "  environment {\n"
                    ],
                    [
                        50,
                        "    variables = var.environment_variables\n"
                    ],
                    [
                        51,
                        "  }\n"
                    ],
                    [
                        52,
                        "\n"
                    ],
                    [
                        53,
                        "  dynamic \"vpc_config\" {\n"
                    ],
                    [
                        54,
                        "    for_each = var.custom_vpc_enabled ? [1] : []\n"
                    ],
                    [
                        55,
                        "    content {\n"
                    ],
                    [
                        56,
                        "      subnet_ids         = var.subnet_ids\n"
                    ],
                    [
                        57,
                        "      security_group_ids = var.security_group_ids\n"
                    ],
                    [
                        58,
                        "    }\n"
                    ],
                    [
                        59,
                        "  }\n"
                    ],
                    [
                        60,
                        "\n"
                    ],
                    [
                        61,
                        "  tags = var.tags\n"
                    ],
                    [
                        62,
                        "}\n"
                    ]
                ],
                "file_path": "/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_abs_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "repo_file_path": "/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_line_range": [
                    27,
                    62
                ],
                "resource": "aws_lambda_function.this",
                "evaluations": null,
                "check_class": "checkov.common.graph.checks_infra.base_check",
                "fixed_definition": null,
                "entity_tags": {
                    "Environment": "dev",
                    "Project": "lambda-demo"
                },
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": "HIGH",
                "bc_category": null,
                "benchmarks": {},
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": null,
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "breadcrumbs": {
                    "function_name": [
                        {
                            "type": "variable",
                            "name": "name",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        },
                        {
                            "type": "resource",
                            "name": "aws_lambda_function.this",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                            "module_connection": false
                        }
                    ],
                    "filename": [
                        {
                            "type": "variable",
                            "name": "filename",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "handler": [
                        {
                            "type": "variable",
                            "name": "handler",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "image_uri": [
                        {
                            "type": "variable",
                            "name": "image_uri",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "layers": [
                        {
                            "type": "variable",
                            "name": "layers",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "package_type": [
                        {
                            "type": "variable",
                            "name": "use_image",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "runtime": [
                        {
                            "type": "variable",
                            "name": "runtime",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "s3_bucket": [
                        {
                            "type": "variable",
                            "name": "s3_bucket",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "s3_key": [
                        {
                            "type": "variable",
                            "name": "s3_key",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "source_code_hash": [
                        {
                            "type": "variable",
                            "name": "source_code_hash",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "timeout": [
                        {
                            "type": "variable",
                            "name": "timeout",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "memory_size": [
                        {
                            "type": "variable",
                            "name": "memory_size",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "environment.variables": [
                        {
                            "type": "variable",
                            "name": "environment_variables",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "tags": [
                        {
                            "type": "variable",
                            "name": "tags",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.content.subnet_ids": [
                        {
                            "type": "variable",
                            "name": "subnet_ids",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.content": [
                        {
                            "type": "variable",
                            "name": "security_group_ids",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config": [
                        {
                            "type": "variable",
                            "name": "custom_vpc_enabled",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.content.security_group_ids": [
                        {
                            "type": "variable",
                            "name": "security_group_ids",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.for_each": [
                        {
                            "type": "variable",
                            "name": "custom_vpc_enabled",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "role": [
                        {
                            "type": "variable",
                            "name": "role_arn",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CUSTOM_LAMBDA_REQUIRED_TAGS",
                "bc_check_id": null,
                "check_name": "Ensure Lambda function has required tags",
                "check_result": {
                    "result": "FAILED",
                    "entity": {
                        "aws_lambda_function": {
                            "this": {
                                "__end_line__": 62,
                                "__start_line__": 27,
                                "dynamic": [
                                    {
                                        "vpc_config": [
                                            {
                                                "security_group_ids": [
                                                    "var.security_group_ids"
                                                ],
                                                "subnet_ids": [
                                                    "var.subnet_ids"
                                                ]
                                            }
                                        ]
                                    }
                                ],
                                "environment": [
                                    {
                                        "variables": [
                                            {
                                                "ENV": "dev"
                                            }
                                        ]
                                    }
                                ],
                                "filename": [
                                    "lambda.zip"
                                ],
                                "function_name": [
                                    "my-lambda-function"
                                ],
                                "handler": [
                                    "main.handler"
                                ],
                                "image_uri": [
                                    "None"
                                ],
                                "layers": [
                                    []
                                ],
                                "memory_size": [
                                    128
                                ],
                                "package_type": [
                                    "Zip"
                                ],
                                "role": [
                                    "aws_iam_role.lambda_exec[0].arn"
                                ],
                                "runtime": [
                                    "python3.10"
                                ],
                                "s3_bucket": [
                                    "my-lambda-artifacts"
                                ],
                                "s3_key": [
                                    "lambda.zip"
                                ],
                                "source_code_hash": [
                                    ""
                                ],
                                "tags": [
                                    {
                                        "Environment": "dev",
                                        "Project": "lambda-demo"
                                    }
                                ],
                                "timeout": [
                                    10
                                ],
                                "__address__": "aws_lambda_function.this"
                            }
                        }
                    },
                    "evaluated_keys": [
                        "tags/Environment",
                        "tags/Owner"
                    ]
                },
                "code_block": [
                    [
                        27,
                        "resource \"aws_lambda_function\" \"this\" {\n"
                    ],
                    [
                        28,
                        "  function_name = var.name\n"
                    ],
                    [
                        29,
                        "\n"
                    ],
                    [
                        30,
                        "  role = var.create_role ? aws_iam_role.lambda_exec[0].arn : var.role_arn\n"
                    ],
                    [
                        31,
                        "\n"
                    ],
                    [
                        32,
                        "  package_type = var.use_image ? \"Image\" : \"Zip\"\n"
                    ],
                    [
                        33,
                        "\n"
                    ],
                    [
                        34,
                        "  # ZIP-based\n"
                    ],
                    [
                        35,
                        "  filename         = var.use_image == false ? var.filename : null\n"
                    ],
                    [
                        36,
                        "  s3_bucket        = var.use_image == false ? var.s3_bucket : null\n"
                    ],
                    [
                        37,
                        "  s3_key           = var.use_image == false ? var.s3_key : null\n"
                    ],
                    [
                        38,
                        "  source_code_hash = var.use_image == false ? var.source_code_hash : null\n"
                    ],
                    [
                        39,
                        "  runtime          = var.use_image == false ? var.runtime : null\n"
                    ],
                    [
                        40,
                        "  handler          = var.use_image == false ? var.handler : null\n"
                    ],
                    [
                        41,
                        "  layers           = var.use_image == false ? var.layers : null\n"
                    ],
                    [
                        42,
                        "\n"
                    ],
                    [
                        43,
                        "  # Image-based\n"
                    ],
                    [
                        44,
                        "  image_uri = var.use_image == true ? var.image_uri : null\n"
                    ],
                    [
                        45,
                        "\n"
                    ],
                    [
                        46,
                        "  timeout     = var.timeout\n"
                    ],
                    [
                        47,
                        "  memory_size = var.memory_size\n"
                    ],
                    [
                        48,
                        "\n"
                    ],
                    [
                        49,
                        "  environment {\n"
                    ],
                    [
                        50,
                        "    variables = var.environment_variables\n"
                    ],
                    [
                        51,
                        "  }\n"
                    ],
                    [
                        52,
                        "\n"
                    ],
                    [
                        53,
                        "  dynamic \"vpc_config\" {\n"
                    ],
                    [
                        54,
                        "    for_each = var.custom_vpc_enabled ? [1] : []\n"
                    ],
                    [
                        55,
                        "    content {\n"
                    ],
                    [
                        56,
                        "      subnet_ids         = var.subnet_ids\n"
                    ],
                    [
                        57,
                        "      security_group_ids = var.security_group_ids\n"
                    ],
                    [
                        58,
                        "    }\n"
                    ],
                    [
                        59,
                        "  }\n"
                    ],
                    [
                        60,
                        "\n"
                    ],
                    [
                        61,
                        "  tags = var.tags\n"
                    ],
                    [
                        62,
                        "}\n"
                    ]
                ],
                "file_path": "/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_abs_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "repo_file_path": "/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_line_range": [
                    27,
                    62
                ],
                "resource": "aws_lambda_function.this",
                "evaluations": null,
                "check_class": "checkov.common.graph.checks_infra.base_check",
                "fixed_definition": null,
                "entity_tags": {
                    "Environment": "dev",
                    "Project": "lambda-demo"
                },
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": "MEDIUM",
                "bc_category": null,
                "benchmarks": {},
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": null,
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "breadcrumbs": {
                    "function_name": [
                        {
                            "type": "variable",
                            "name": "name",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        },
                        {
                            "type": "resource",
                            "name": "aws_lambda_function.this",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                            "module_connection": false
                        }
                    ],
                    "filename": [
                        {
                            "type": "variable",
                            "name": "filename",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "handler": [
                        {
                            "type": "variable",
                            "name": "handler",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "image_uri": [
                        {
                            "type": "variable",
                            "name": "image_uri",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "layers": [
                        {
                            "type": "variable",
                            "name": "layers",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "package_type": [
                        {
                            "type": "variable",
                            "name": "use_image",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "runtime": [
                        {
                            "type": "variable",
                            "name": "runtime",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "s3_bucket": [
                        {
                            "type": "variable",
                            "name": "s3_bucket",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "s3_key": [
                        {
                            "type": "variable",
                            "name": "s3_key",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "source_code_hash": [
                        {
                            "type": "variable",
                            "name": "source_code_hash",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "timeout": [
                        {
                            "type": "variable",
                            "name": "timeout",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "memory_size": [
                        {
                            "type": "variable",
                            "name": "memory_size",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "environment.variables": [
                        {
                            "type": "variable",
                            "name": "environment_variables",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "tags": [
                        {
                            "type": "variable",
                            "name": "tags",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.content.subnet_ids": [
                        {
                            "type": "variable",
                            "name": "subnet_ids",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.content": [
                        {
                            "type": "variable",
                            "name": "security_group_ids",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config": [
                        {
                            "type": "variable",
                            "name": "custom_vpc_enabled",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.content.security_group_ids": [
                        {
                            "type": "variable",
                            "name": "security_group_ids",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "dynamic.vpc_config.for_each": [
                        {
                            "type": "variable",
                            "name": "custom_vpc_enabled",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "role": [
                        {
                            "type": "variable",
                            "name": "role_arn",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CUSTOM_LAMBDA_INTERNAL_VPC",
                "bc_check_id": null,
                "check_name": "Internal Lambda must run in VPC",
                "check_result": {
                    "result": "FAILED",
                    "entity": {
                        "aws_lambda_function_url": {
                            "this[0]": {
                                "__end_line__": 74,
                                "__start_line__": 64,
                                "authorization_type": [
                                    "NONE"
                                ],
                                "cors": [
                                    {
                                        "allow_headers": [
                                            [
                                                "*"
                                            ]
                                        ],
                                        "allow_methods": [
                                            [
                                                "*"
                                            ]
                                        ],
                                        "allow_origins": [
                                            [
                                                "*"
                                            ]
                                        ]
                                    }
                                ],
                                "function_name": [
                                    "my-lambda-function"
                                ],
                                "__address__": "aws_lambda_function_url.this[0]"
                            }
                        }
                    },
                    "evaluated_keys": [
                        "vpc_config",
                        "tags/purpose"
                    ]
                },
                "code_block": [
                    [
                        64,
                        "resource \"aws_lambda_function_url\" \"this\" {\n"
                    ],
                    [
                        65,
                        "  count              = var.enable_function_url ? 1 : 0\n"
                    ],
                    [
                        66,
                        "  function_name      = aws_lambda_function.this.function_name\n"
                    ],
                    [
                        67,
                        "  authorization_type = var.function_url_auth_type\n"
                    ],
                    [
                        68,
                        "\n"
                    ],
                    [
                        69,
                        "  cors {\n"
                    ],
                    [
                        70,
                        "    allow_origins = [\"*\"]\n"
                    ],
                    [
                        71,
                        "    allow_methods = [\"*\"]\n"
                    ],
                    [
                        72,
                        "    allow_headers = [\"*\"]\n"
                    ],
                    [
                        73,
                        "  }\n"
                    ],
                    [
                        74,
                        "}\n"
                    ]
                ],
                "file_path": "/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_abs_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "repo_file_path": "/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "file_line_range": [
                    64,
                    74
                ],
                "resource": "aws_lambda_function_url.this[0]",
                "evaluations": null,
                "check_class": "checkov.common.graph.checks_infra.base_check",
                "fixed_definition": null,
                "entity_tags": {},
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": "HIGH",
                "bc_category": null,
                "benchmarks": {},
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": null,
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                "breadcrumbs": {
                    "authorization_type": [
                        {
                            "type": "variable",
                            "name": "function_url_auth_type",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        }
                    ],
                    "function_name": [
                        {
                            "type": "variable",
                            "name": "name",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/variables.tf",
                            "module_connection": false
                        },
                        {
                            "type": "resource",
                            "name": "aws_lambda_function.this",
                            "path": "/home/runner/work/terraform-advanced/terraform-advanced/infrastructure/envs/dev/image-uploader-lambda/.terragrunt-cache/GptlL6hBj1nupL38VKt2MLbUMqg/FCLts8-J27icBsAMH5XuSaiH3P8/main.tf",
                            "module_connection": false
                        }
                    ]
                }
            }
        ],
        "skipped_checks": [],
        "parsing_errors": []
    },
    "summary": {
        "passed": 2,
        "failed": 5,
        "skipped": 0,
        "parsing_errors": 0,
        "resource_count": 6,
        "checkov_version": "3.2.447"
    },
    "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"
}
